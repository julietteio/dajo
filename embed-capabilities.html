<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Embed â€¢ Capabilities</title>
  <style>
    html, body { height: 100%; margin: 0; }
    #capabilities { height: clamp(320px, 75vw, 520px); }
    @media (max-width: 600px) {
        #capabilities .highcharts-data-label { display: none !important; }
    }
  </style>
</head>
<body>
  <div id="capabilities" aria-label="Capabilities variable pie"></div>

  <!-- Highcharts -->
  <script src="https://cdn.jsdelivr.net/npm/highcharts@11.4.8/highcharts.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/highcharts@11.4.8/modules/variable-pie.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/highcharts@11.4.8/modules/accessibility.min.js"></script>

  <script>
    // Render chart
    Highcharts.chart('capabilities', {
    chart: { type: 'variablepie' },
    title: { text: null },
    subtitle: { text: null },                 // remove note
    credits: { enabled: false },
    legend: { enabled: false },               // remove legend
    colors: [
        '#4caefe',
        '#3dc3e8',
        '#2dd9db',
        '#1feeaf',
        '#0ff3a0',
        '#00e887',
        '#23e274'
    ],
    tooltip: {
    useHTML: true,
    formatter: function () {
      return `<b>${this.point.name}</b>`;   // name only
        }
    },
    series: [{
    name: 'Capabilities',
    minPointSize: 15,
    innerSize: '20%',                       // smaller donut hole
    zMin: 50,
    zMax: 100,
    dataLabels: { enabled: true, format: '{point.name}', style: { textOutline: 'none' } },
    data: [
    { name: 'Education',   y: 33, z: 92 },
    { name: 'Housing',          y: 15, z: 96 },
    { name: 'Health', y: 15, z: 86 },
    { name: 'Climate',         y: 10, z: 82 },
    { name: 'Early childhood',             y: 10, z: 78 },
    { name: 'Transport',           y: 8,  z: 74 },
    { name: 'Security',            y: 8,  z: 88 }
    ]
    }],
    // Mobile rules
    responsive: {
    rules: [{
    condition: { maxWidth: 600 },
    chartOptions: {
      series: [{ dataLabels: { enabled: false } }],
      plotOptions: { variablepie: { dataLabels: { enabled: false } } }
    }
  }]
}


});


    // Auto-resize: post height to parent (for your Option B embed)
    (function () {
      const target = document.getElementById('capabilities');
      const ro = new ResizeObserver(() => {
        const h = Math.max(
          document.documentElement.scrollHeight,
          document.body.scrollHeight,
          target.offsetHeight
        );
        window.parent && window.parent.postMessage({ type: 'hc-embed-size', height: h }, '*');
      });
      ro.observe(target);
      // Fire once on load
      window.parent && window.parent.postMessage({ type: 'hc-embed-size', height: target.offsetHeight }, '*');
    })();
  </script>
</body>
</html>
